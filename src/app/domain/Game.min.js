(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}};define(["underscore","domain/Background","domain/Nave","infrastructure/TimeManager"],function(t,i,r,u){return function(){function f(t){this.$canvas=t,this.start=n(this.start,this),this.run=n(this.run,this),this.updates=n(this.updates,this),this.draw=n(this.draw,this),this.context=this.$canvas.getContext("2d"),this.timeManager=new u,this.nave=new r,this.backgrounds={bg1:new i("bg1",2.5),bg2:new i("bg2",10),bg3:new i("bg3",5)}}return f.prototype.draw=function(){var n=this;return this.context.clearRect(0,0,this.$canvas.width,this.$canvas.height),this.context.drawImage(this.nave.image,this.nave.getRow(),this.nave.getCol(),this.nave.width,this.nave.height,this.nave.pos.x,this.nave.pos.y,this.nave.width*2,this.nave.height*2),t.each(this.backgrounds,function(t){return n.context.drawImage(t.image,t.pos.x,0),n.context.drawImage(t.image,t.pos.x+t.image.width,0)})},f.prototype.updates=function(){var n=this;return this.nave.updates(),t.each(this.backgrounds,function(n){return n.updates()}),this.draw()},f.prototype.run=function(){return this.timeManager.canUpdate()&&this.updates(),window.setTimeout(this.run(),1e3/60)},f.prototype.start=function(){return this.draw(),this.run()},f}()})}).call(this)